services:
    mysql:
        image: 'mysql:latest'
        container_name: 'mysql'
        environment:
            - 'MYSQL_DATABASE=mydatabase'
            - 'MYSQL_PASSWORD=secret'
            - 'MYSQL_ROOT_PASSWORD=verysecret'
            - 'MYSQL_USER=myuser'
        ports:
            - '3306'
        networks:
            - app-network
        healthcheck:
            test:
                [
                    'CMD',
                    'mysqladmin',
                    'ping',
                    '-h',
                    'localhost',
                    '-u',
                    'myuser',
                    '-psecret',
                    '--silent',
                ]
            interval: 10s
            timeout: 5s
            retries: 10
    app:
        build: .
        depends_on:
            mysql:
                condition: service_healthy
        ports:
            - '3000:3000'
        networks:
            - app-network

networks:
    app-network:
